# hse24_hw4

## Подготовил

Пашенцев Павел Владимирович

# Анализ экспрессии маркерных генов

Данный репозиторий содержит ноутбук с пошаговым выполнением анализа экспрессии маркерных генов. Основные этапы включают нормализацию данных, построение heatmap для маркерных генов, визуализации методом UMAP и PCA, а также анализ результатов.

## Код

Весь код хранится по [ссылке](/src/main.ipynb).

# Часть 1

# Метод нормализации данных

В качестве нормализации данных использовался метод TPM.

## Визуализация данных

### Heatmap для экспрессии маркерных генов
На основе предварительного отбора генов были построены тепловые карты с использованием библиотеки Seaborn. Тепловые карты показывают уровень экспрессии маркерных генов между различными группами клеток. Основные параметры:
- Данные масштабированы в пределах каждого гена.
- Используются группировки на основе кластеров.

![](/img/heatmap.png)

# Визуализация UMAP и PCA

### Визуализации UMAP и PCA
1. **UMAP**:
   - Метод нелинейного уменьшения размерности, использующий соседние точки для визуализации данных в двумерном пространстве.
   - Использовался для визуализации кластеров клеток.

Основные наблюдения:
1.	Кластеры клеток:
    - Хорошо различимы кластеры для типов mTEC-I и mTEC-II. Это свидетельствует о том, что эти группы клеток имеют существенные различия в экспрессии генов.
	- Типы mTEC-III и mTEC-IV менее чётко разделены, что может говорить о близком профиле экспрессии генов или переходной зоне между этими типами.
2.	Распределение в пространстве PCA:
	- Компоненты PC1 и PC2 объясняют большую часть вариации данных.
	- Тип cTEC заметно выделяется от других типов клеток, что может указывать на их особую биологическую роль или уникальность экспрессии маркерных генов.
3.	Потенциальные переходные состояния:
	- Наблюдаются клетки, расположенные между кластерами (например, между mTEC-II и mTEC-III), что может свидетельствовать о промежуточных состояниях дифференцировки.

Выводы:
- Анализ PCA подтверждает структурированность данных и показывает, что различные типы клеток имеют различимые профили экспрессии.
- Менее чёткое разделение некоторых групп (например, mTEC-III и mTEC-IV) может потребовать дополнительного анализа с использованием других методов, таких как кластеризация или UMAP.
- Для более глубокого понимания биологических различий между клетками можно дополнительно исследовать экспрессию ключевых маркерных генов для каждой группы.

![](/img/umap.png)

2. **PCA**:
   - Метод главных компонент для линейного уменьшения размерности данных.
   - Применён для анализа распределения данных и выделения основной вариабельности.

Наблюдения:
1.	Кластеры клеток:
    - Клетки разных типов (cTEC, mTEC-I, mTEC-II, mTEC-III, mTEC-IV) формируют относительно четко различимые группы.
	- Наиболее выражены кластеры mTEC-I и mTEC-II, которые занимают хорошо обособленные участки пространства PCA.
	- Кластеры mTEC-III и mTEC-IV частично пересекаются, что может свидетельствовать о схожести их генетических профилей или наличии переходного состояния.
2.	Положение cTEC:
	- Клетки cTEC заметно выделяются и занимают отдельный угол графика, что свидетельствует об их уникальных характеристиках в сравнении с остальными типами клеток.
3.	Вариабельность:
	- Первая главная компонента (PC1) объясняет больше вариации в данных, что видно по горизонтальному растяжению точек вдоль оси PC1.
	- Вторая компонента (PC2) также вносит вклад, но менее значительный, что можно интерпретировать как дополнительные различия между клеточными типами.
4.	Переходные зоны:
	- В некоторых местах кластеры частично перекрываются, например, между mTEC-II и mTEC-III. Это может указывать на биологические процессы, такие как дифференцировка или трансдифференцировка клеток.

Выводы:
- PCA позволяет увидеть основное разделение клеточных типов на основании их генетических профилей.
- Некоторые клеточные типы, например, cTEC и mTEC-I, имеют ярко выраженные характеристики, тогда как другие (например, mTEC-III и mTEC-IV) могут требовать дополнительного анализа, например, с использованием UMAP или кластеризации.
- Для подтверждения гипотез о биологических процессах можно исследовать экспрессию маркерных генов, соответствующих каждому кластеру, или применить альтернативные метрики кластеризации.

![](/img/pca.png)

## Анализ результатов
- Обнаружены чётко выраженные кластеры клеток, соответствующие ожидаемым биологическим группам.
- Heatmap подтвердил дифференцированную экспрессию ключевых маркерных генов.
- Методы UMAP и PCA показали согласованность распределения кластеров.

# Часть 2

## Анализ графика "Средняя экспрессия по группам"

### Описание графика
На графике отображается распределение средней экспрессии генов между двумя группами:
- **Ось X**: Группа "bulk" (общая экспрессия).
- **Ось Y**: Группа "mTEC-IV" (определённый клеточный тип).

Каждая точка представляет один ген, а её положение на графике указывает на уровень экспрессии в двух сравниваемых группах.

### Наблюдения
1. **Кластеры точек**:
   - Большинство точек расположено вблизи нижнего левого угла, что указывает на низкий уровень средней экспрессии в обеих группах.
   - Несколько точек находятся вдали от основной массы данных (в верхней части или справа), что свидетельствует о генах с высокой экспрессией в одной из групп.

2. **Различия между группами**:
   - Точки с высокой экспрессией по оси Y ("mTEC-IV") и низкой по оси X ("bulk") могут быть маркерами, специфичными для клеточного типа mTEC-IV.
   - Напротив, точки с высокой экспрессией по оси X и низкой по оси Y указывают на гены, активные в общей популяции клеток, но подавленные в mTEC-IV.

3. **Специфические гены**:
   - Значения, сильно отклоняющиеся от диагональной линии, являются интересными целями для анализа, так как они демонстрируют значительные различия в экспрессии между группами.

### Выводы
- Гены с высокой экспрессией в "mTEC-IV" могут представлять собой потенциальные маркеры данного клеточного типа.
- Гены, слабо экспрессирующиеся в "mTEC-IV", но высоко экспрессирующиеся в "bulk", могут быть более универсальными или характерными для других типов клеток.
- Для более глубокого анализа можно рассчитать корреляцию между группами или дополнительно исследовать гены с экстремальными значениями.

![](/img/avg.png)

## Анализ графика "Разница и среднее значение экспрессии"

### Описание графика
График иллюстрирует зависимость между:
- **Ось X**: Среднее значение экспрессии генов.
- **Ось Y**: Разница в уровнях экспрессии генов между группами.

Каждая точка на графике представляет один ген.

### Наблюдения
1. **Плотность точек**:
   - Большая часть точек сосредоточена вблизи начала координат, что указывает на низкие значения как средней экспрессии, так и её изменчивости.

2. **Гены с высокой средней экспрессией**:
   - Точки, расположенные далеко вправо по оси X (выше 10,000), указывают на гены с высокой средней экспрессией.
   - Эти гены, как правило, связаны с базовыми клеточными функциями и имеют стабильный уровень экспрессии.

3. **Гены с высокой вариабельностью**:
   - Гены с большими значениями по оси Y (разница) демонстрируют значительные изменения экспрессии между группами.
   - Один ген с экстремально высокими значениями по обеим осям выделяется как кандидат для дальнейшего анализа.

### Выводы
- Большинство генов демонстрируют низкие значения как средней экспрессии, так и вариации, что характерно для данных экспрессии.
- Гены с высокой средней экспрессией могут быть базовыми или универсальными для всех клеток.
- Гены с высокой вариацией требуют дополнительного анализа для выявления их биологических функций.

![](/img/diff.png)


## Анализ графика "Две группы по отклонению от среднего"

### Описание графика
На графике показано распределение данных двух групп (`True` и `False`) по двум переменным:
- **Ось X**: Значения "bulk".
- **Ось Y**: Значения "mTEC-IV".

Группа `True` (оранжевые точки) выделена как набор значений с минимальным отклонением от среднего, тогда как группа `False` (синие точки) включает более вариативные данные.

### Наблюдения
1. **Общая структура**:
   - Наблюдается положительная корреляция между значениями "bulk" и "mTEC-IV". Точки лежат вдоль диагонали, показывая согласованность между двумя группами.

2. **Группы**:
   - Группа `True` сосредоточена вдоль диагонали, что может указывать на значения с низкой изменчивостью.
   - Группа `False` демонстрирует более широкое распределение, включая значения как на диагонали, так и с отклонениями от неё.

3. **Высокие значения**:
   - Высокие значения (выше 80 по обеим осям) характеризуются высокой согласованностью между группами.

4. **Плотность данных**:
   - Большинство данных сосредоточено в диапазоне низких значений (0–40), что может быть связано с преобладанием генов или измерений с низким уровнем отклонений.

### Выводы
- Группа `True` может включать данные, характеризующиеся стабильностью и минимальным отклонением от среднего.
- Группа `False` отражает данные с большей изменчивостью, что может быть связано с биологической спецификой или активностью.
- Общая корреляция между значениями "bulk" и "mTEC-IV" указывает на согласованность измерений.

![](/img/groups.png)

## Pydeseq2

В результате анализа с помощью pydeseq2 было получено summary.

![](/img/summary.png)

### MA Plot
MA Plot используется для анализа связи между средней экспрессией генов и изменением экспрессии (fold change).

#### Наблюдения:
- **Ось X**: Средние нормализованные значения экспрессии (логарифмическая шкала).
- **Ось Y**: Log2 fold change, показывающий степень изменения экспрессии.
- Большинство точек сосредоточено около красной линии (log2 fold change = 0), что указывает на отсутствие значительных изменений у большинства генов.
- Гены с большими изменениями экспрессии (выходящие за пределы \( \pm1.0 \)) могут представлять биологически значимые кандидаты для дальнейшего анализа.

#### Выводы:
- MA Plot демонстрирует равномерное распределение данных.
- Экстремальные значения требуют дополнительного анализа для выявления биологической значимости.


![](/img/plot_MA.png)

### Volcano Plot
Volcano Plot позволяет анализировать логарифмическое изменение экспрессии и его статистическую значимость.

#### Наблюдения:
- **Ось X**: Log2 fold change, указывающий направление изменения экспрессии.
- **Ось Y**: \(-\log_{10}(p-value)\), показывающий статистическую значимость.
- Большинство точек расположено ближе к низу графика, что указывает на низкую значимость изменений.
- На графике отсутствуют точки, пересекающие линию значимости, что может свидетельствовать о биологической консервативности данных или недостаточной мощности статистического анализа.

#### Выводы:
- На графике не выявлено значимых изменений экспрессии.
- Для улучшения анализа можно пересчитать p-value с использованием менее строгих порогов или увеличить мощность выборки.


![](/img/volcano_plot.png)